"use strict";$(function(){function e(){b.each(function(e,n){var t=$(n);t.data(z,t.attr("class")),t.data(A,e),0===e&&t.addClass("music-mind-page-current")}),$(".music-mind-page-button").on("click",function(){return n(r)}),$(".answer-section input:radio").change(c),j.click(function(){return v.flickity("previous")}),I.click(function(){return v.flickity("next")}),v.on("select.flickity",function(){var e=v.data("flickity");T.text("QUESTION #:"+(e.selectedIndex+1)),I.prop("disabled",e.selectedIndex==e.cells.length-1)}),$("#signup-form").submit(p),$("#final-signup-form").submit(p),$("#no-button").click(function(e){e.preventDefault(),n(r)}),C?$("#debug").click(function(){for(E=!0;v.data("flickity").cells.length<g.length;){var e=o(),t=e.find("input:radio"),i=Math.floor(Math.random()*t.length);t.eq(i).prop("checked",!0)}n(),E=!1}):$("#debug").hide()}function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(M)return!1;M=!0;var r=t(),o=b.eq(r),s=a>-1?q>a?a:0:q-1>r?r+1:0,c=b.eq(s).addClass("music-mind-page-current"),u=s>r?"moveToTop":"moveToBottom",d=s>r?"moveFromBottom":"moveFromTop";e&&e(r,s),o.addClass(u).on(L,function(){o.off(L),D=!0,F&&i(o,c,n)}),c.addClass(d).on(L,function(){c.off(L),F=!0,D&&i(o,c,n)}),N||i(o,c,n)}function t(){return parseInt($(".music-mind-page-current").data(A))}function i(e,n,t){D=!1,F=!1,a(e,n),M=!1,t&&t()}function a(e,n){e.attr("class",e.data(z)),n.attr("class",n.data(z)+" music-mind-page-current")}function r(e,n){switch(n){case 1:o();break;case 3:l();break;case 4:G&&($("#final-cta").hide(),$("#final-message").show())}}function o(){var e=v.data("flickity").cells.length,n=g[e],t=(g.length-e)/g.length*100,i=s(e+1,n.text,n.mindType);return v.flickity("append",i),v.flickity("next"),k.animate({width:100-t+"%"},"slow"),i}function s(e,n,t){var i=("tie-breaker"===t?x:w).clone().show(),a="tie-breaker"===t?"tie-breaker-answer":"question-"+e+"-answer";return i.find("h2").text("Question "+e),i.find("p").text(n),i.find("div.answer-section").addClass(t).find("input:radio").each(function(e,n){return $(n).change(c).attr("name",a)}),i}function c(e){var t=$(e.currentTarget).attr("name");"tie-breaker-answer"===t?n():window.setTimeout(o,1e3)}function u(){var e=function(e,n){return e+n},n=function(e){return $(e+" input:checked").map(function(e,n){return parseInt($(n).val())}).get()};return{eye:n(".eye").reduce(e),ear:n(".ear").reduce(e),create:n(".create").reduce(e)}}function d(){var e=$("div.tie-breaker input:checked").val(),n=u();n[e]++;var t=Object.keys(n).reduce(function(e,t){return n[e]>n[t]?e:t});return{mindType:t,breakdown:n}}function l(){var e=d();for(var n in e.breakdown)$("#"+n+"-result").text(e.breakdown[n]);$(".music-mind-result").text(e.mindType),h[e.mindType].forEach(function(e){return $("#strengths-list").append("<li>"+e+"</li>")})}function m(e){var n=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;return n.test(e)}function f(e,n,t){var i=d(),a="https://pazumusic.us13.list-manage.com/subscribe/post-json?u=97e39215ad5ad59c825210614&id=855559e5b6",r=e.serialize()+("&MMIND="+i.mindType);$.get({url:a,data:r,cache:!1,dataType:"jsonp",jsonp:"c",contentType:"application/json; charset=utf-8",error:function(){return alert("Could not connect to the registration server. Please try again later.")},success:function(e){return"success"!=e.result?t():n()}})}function p(e){e.preventDefault();var t=$(e.currentTarget),i=t.find("input[name=EMAIL]"),a=t.find("#error-response");return m(i.val())?(i.css("border","1px solid #aaa"),a.hide(),f(t,function(){G=!0,n(r)}),void 0):(i.css("border","1px solid #ff0000"),void a.show())}var g=[{mindType:"ear",text:"I learn well by listening to others."},{mindType:"create",text:"I find myself daydreaming often."},{mindType:"eye",text:"I enjoy getting lost in a good book."},{mindType:"create",text:"I don't like it when rules and structure are in place."},{mindType:"ear",text:"I like to sing songs."},{mindType:"eye",text:"I enjoy writing in a journal or diary."},{mindType:"create",text:"I enjoy thinking of new ways to do simple tasks."},{mindType:"eye",text:"I love to navigate and read maps."},{mindType:"ear",text:"I find it easy to memorize melodies and lyrics."},{mindType:"tie-breaker",text:"If you were going to learn a song right now, which way would you prefer?"}],y={WebkitAnimation:"webkitAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd",animation:"animationend"},h={eye:["Great at following directions","Can easily visualize the notes","Great sense of musical balance","Notices small differences in written music"],ear:["Can easily remember melodies and lyrics","Frequently humming or singing music","Learns better while studying to music","Prefers to find notes by listening rather than reading"],create:["Very imaginative and inventive","Great sense of self awareness","Enjoys finding new ways to sing or play songs","Expression is always an important factor"]},v=$(".main-carousel").flickity(),k=$(".progress-bar-fill"),b=$(".music-mind-container").children("div.music-mind-page"),w=$("#quiz-question-template"),x=$("#tie-breaker-template"),T=$("#question-number"),I=$("#next-question"),j=$("#prev-question"),q=b.length,z="originalClassList",A="pageIndex",C=!0,E=!1,M=!1,D=!1,F=!1,G=!1,L=y[Modernizr.prefixed("animation")],N=Modernizr.cssanimations;e()});
